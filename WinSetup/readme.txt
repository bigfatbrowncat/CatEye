For compiling add path to NSIS compiler "makensis" to your path environment.
Also You need "Inetc" and "GetVersion" plugins for NSIS. You may download these plugins from oficional NSIS site (http://nsis.sourceforge.net/Category:Plugins).

! Add instruction about plugins.

! Added CommCtrl.nsh header file (http://nsis.sourceforge.net/Header_file_for_Listview).